# Accounts
source ~/.mutt/accounts/whi-settings
macro index <f2> '<enter-command>source ~/.mutt/accounts/whi-settings<enter><change-folder>+inbox<enter>'
macro index <f3> '<enter-command>source ~/.mutt/accounts/onm-settings<enter><change-folder>+inbox<enter>'

# Settings
set timeout           = 10
set mail_check        = 5
set header_cache      = ~/.mutt/cache/headers
set message_cachedir  = ~/.mutt/cache/bodies
set certificate_file  = ~/.mutt/certificates
set sendmail_wait     = 0                     # wait for sending to finish
unset record                                  # no copy for sent items (gmail/msmtp)
set quit                                      # no confirm quitting
unset move                                    # no confirm moving messages
unset confirmappend                           # no confirm moving messages
set delete                                    # automatic purge
set include                                   # include original message in reply
set sort              = 'reverse-threads'
set sort_aux          = 'last-date-received'
set auto_tag                                  # do not require tag prefix when having tagged messages
set sig_dashes        = no
set sig_on_top
set fast_reply                                # skip prompts
set reply_to                                  # use this header
set pager_index_lines = 15
set to_chars          = ' +>-<L'
unset beep
unset resolve                                 # do not move cursor to next message
set menu_scroll                               # do not clear screen with large menus
set tilde                                     # vim tilde behaviour
unset markers                                 # hide + prefix in pager
ignore "Authentication-Results:"
ignore "DomainKey-Signature:"
ignore "DKIM-Signature:"
hdr_order Date From To Cc
alternative_order text/plain text/html *
auto_view text/html
ignore *
unignore From: To: Date: Subject:

# Key bindings
bind  index gg    first-entry
bind  index G     last-entry
bind  index <tab> sync-mailbox
bind  index N     search-opposite
bind  pager N     search-opposite
macro index O     "<shell-escape>offlineimap -o<enter>"                           "run offlineimap to sync all mail"
macro index o     "<shell-escape>offlineimap -oqf INBOX<enter>"                 "run offlineimap to sync inbox"
macro index \Cr   "T~U<enter><tag-prefix><clear-flag>N<untag-pattern>.<enter>" "mark all messages as read"

# Gmail-style key bindings
folder-hook .           'macro index,pager d "<clear-flag>N<save-message>+trash<enter><sync-mailbox>" "Trash message"'
folder-hook .           'macro index,pager y "<delete-message><sync-mailbox>"      "Remove label"'
folder-hook inbox       'macro index,pager y "<delete-message><sync-mailbox>"      "Archive message"'
folder-hook archive     'macro index,pager y "<save-message>+inbox<enter>"         "Move to inbox"'
folder-hook spam        'macro index,pager y "<save-message>+inbox<enter>"         "Move to inbox"'
folder-hook trash       'macro index,pager y "<save-message>+inbox<enter>"         "Move to inbox"'
folder-hook trash       'macro index,pager d "<delete-message><sync-mailbox>"      "Perm delete"'
folder-hook flagged     bind   index,pager y flag-message
bind  index,pager a   group-reply
macro index,pager gi "<change-folder>+inbox<enter>" "Go to Inbox"
macro index,pager gs "<change-folder>+sent<enter>" "Go to Sent"
macro index,pager ga "<change-folder>+archive<enter>" "Go to Archive"
macro index,pager gt "<change-folder>+trash<enter>" "Go to Trash"
#macro index,pager ! "<save-message>=[Gmail]/Spam<enter><enter>" "Report spam"
#bind  index,pager s flag-message
#bind  index,pager \# delete-thread
#bind  index,pager l copy-message
#macro index,pager I <clear-flag>O "Mark as read"
#macro index,pager U <set-flag>O "Mark as unread"

# Sync contacts: needs goobook, ~/.goobookrc
set query_command = "goobook query '%s'"
bind  editor <tab> complete-query
macro index  n     "<pipe-message>goobook add<return>" "Add sender to google contacts"
macro pager  n     "<pipe-message>goobook add<return>" "Add sender to google contacts"

# urlview
macro pager  \Cu   <pipe-entry>'urlview'<enter> 'Follow links with urlview'

# attachment path prefix
macro attach s     <save-entry><bol>/Users/roderick/Downloads/<eol>

# sidebar
set sidebar_width   = 20
set sidebar_visible = yes
set sidebar_delim   = '|'
set sidebar_sort    = yes
#color sidebar_new yellow default
bind  index,pager <down>  sidebar-next
bind  index,pager <up>    sidebar-prev
bind  index,pager <right> sidebar-open
bind  index       B       bounce-message
macro index,pager b       "<enter-command>toggle sidebar_visible<enter>" "Toggle sidebar"

# Theme: https://github.com/altercation/mutt-colors-solarized
source ~/.mutt/mutt-colors-solarized/mutt-colors-solarized-dark-256.muttrc
